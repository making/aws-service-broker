applications:
- name: demo-s3
  buildpacks:
  - https://github.com/making/cits-sidecar-buildpack.git
  - java_buildpack_offline
  memory: 768m
  path: ./target/demo-s3-0.0.1-SNAPSHOT.jar
  env:
    JBP_CONFIG_OPEN_JDK_JRE: '{jre: {version: 17.+}}'
    SPRING_CLOUD_AWS_CREDENTIALS_STS_WEBIDENTITYTOKENFILE: /tmp/token
    SPRING_CLOUD_AWS_CREDENTIALS_STS_ROLEARN: ${vcap.services.demo-bucket.credentials.role_arn}
    SPRING_CLOUD_AWS_CREDENTIALS_STS_ROLESESSIONNAME: ${vcap.application.application_name}
    SPRING_CLOUD_AWS_CREDENTIALS_STS_ASYNCCREDENTIALSUPDATE: 'true'
    SPRING_CLOUD_AWS_REGION_STATIC: ${vcap.services.demo-bucket.credentials.region}
    S3_BUCKET: ${vcap.services.demo-bucket.credentials.bucket_name}
    CITS_URL: https://((CITS_DOMAIN))
  services:
  - demo-bucket
